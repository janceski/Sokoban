# Sokoban
Документација за играта Sokoban

Играта Sokoban е имплементација на ретро играта Sokoban од 1981 година. Sokoban е логичка игра во која играчот се наоѓа во улога на работник во складиште кој се обидува сите кутии да ги смести на посакуваните места. За да го оствари ова тој смее да ги бутка кутиите, но не смее да ги влече.
Иако се заснова на едноставни правила сепак одредени нивоа на играта се прилично тешки за решавање и дури и најдобрите човечки решавачи на сокобан може да се подпрат само на одредени хевристички правила при решавање.

Правила на игра
Играта се одигрува на табла составена од повеќе квадрати, каде што секој квадрат може да биде или под или ѕид. Некои од под-полињата содржат кутии, а некои од нив се означени како локации за складирање.
Играчот има одредена почетна позиција на таблата и може да се движи хоризонтално или вертикално на празните полиња во 4 насоки (горе, доле, лево и десно) и никогаш не може да се движи низ ѕидовите или кутиите. Играчот исто така може да се помести и кон кутија, потег кој ја одтурнува кутијата на полето понатаму. Кутиите не можат да бидат бутнати во други кутии или ѕидови и тие не може да бидат влечени. Играта е завршена кога сите кутии ќе бидат на означените локации за складирање.

Имплементација на играта во C#

Податочен дел
За логички да ги раздвоиме главниот екран и екранот каде ќе се одигрува играта тие се поделени во две различни Windows Forms. Во формата Form1 се наоѓа изборот за нова игра со внесување на име на играч и копче со кое се создава инстанца од таа нова игра. Секоја игра e инстанца од класата Board каде и всушност се наоѓа главниот код од играта. 
Она што го чуваме за класата Board e следното:

public partial class Board : Form
    {
        public char[][] levelMap = new char[100][];
        public char[][] pom = new char[100][];
        public int sokoPosX, sokoPosY;
        public int nasoka; // 0-gore 1-desno 2-dole 3-levo
        public int packagesongoal = 0;
        public int numpackages = 0;
        public int nummoves = 0;
        public int pushes = 0;
        public Boolean sokobanongoal = false;
        public List<String> listMoves;	
        public List<String> nivoa;


каде levelMap, матрицата од char-ови ни ја претставува мапата, односно едно поле под од играта. Изборот на карактери кои ќе ги означуваат елементите од играта Сокобан е стандандизиран и се користи од сите главни развивачи на логички нивоа.
'=' – празно поле
'#' – ѕид
'$' – кутија
'.' – цел до која ќе буткаме некоја кутија
'@' – иницијално место на кое се наоѓа сокобанот(човечето)
'*' – пакет/кутија којашто веќе е на целта
' ' – под поле на кое може да се движиме


Потоа матрицата од char-ови ‘pom’ во која ни е сместена иницијалната распределба на полињата и ни помага да не ги измениме полињата по кои изминуваме а се важни за нас, како пример цел полето.

Следните int параметри се со самообјаснувачи имиња и ни ги претставуваат сите оние информации кои ќе сакаме да ги прикажеме на екранот на играта, бројот на буткања на кутија, бројот на движења помеѓу полиња, колку пакети се на целта.

Листата од стрингови listMoves ја користиме за памтење на последните 3 позиции од играта, кои можеме да ги вратиме со притискање на копчето U (undo).

И конечно во листата nivoa ги чуваме сите нивоа кои ги имаме на располагање во играта.

Секое ниво е во формат:

Бр-редици бр-колони~сите редици од матрицата во редослед

Моментално нашава игра располага со 13 нивоа со различна тежина, кои може да бидат надополнети и проширени од било која веб страна која содржи сокобан нивоа.

Опис на фукции за поместување на сокобанот

Влегувањето во ново ниво го прави функцијата enterLevel која од листата на нивоа го зема следното ниво и тоа го внесува во матрицата levelMap.

При движењето на сокобанот внимаваме и проверуваме дали над кутијата што ја буткаме има поле кое што не е сеуште зафатено и не е ѕид. Доколку тоа постои тогаш ја поместуваме таа кутија и ја менуваме состојбата на матрицата levelMap. Почените места од каде сме го направиле движењето ги враќаме на иницијалните вредности какви што биле на почетокот. За ова ни служи pom матрицата.

Приказ на играта

Иницијаниот екран е прилично едноставен и содржи поле во кое што се внесува името на новиот играч и со кликнување на копчето New Game се стартува нова инстанца од класата Board.

 


 

Изглед на едно ниво од играта. Од левата страна е позиционирана таблата на која се игра.  Десно од таблата за играње се наоѓаат метаподатоците за играта како што се името на играчот, бројот на движења и бројот на буткања.

После успешното завршување на секое ниво се појавува порака за успех и се исцртува следното ниво.

Графиките од типот на сокобанот, полињата и ѕидовите се преземени од друга имплементација на сокобан.

Играта се игра со користење на стрелките на тастатурата или движење со копчињата ‘W’ ‘S’ ‘A’ и ‘D’. Освен тоа за враќање на до три одиграни потези се користи копчето ‘U’.
